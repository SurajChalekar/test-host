import{_ as Ee,r as v,c as ge,w as De,o as Oe,a as k,b as g,d as n,f as m,F as Ue,h as Ae,n as S,g as K,t as be}from"./index-CKVgQMtv.js";const Ve={class:"puzzles-page"},He={class:"puzzle-content"},Ie={class:"puzzle-container"},Ge={class:"puzzle-layout"},je={class:"chess-container"},Xe={class:"board-wrapper"},Ye={class:"chess-board",ref:"chessBoard"},Ze=["onClick"],Je=["data-piece"],es={key:1,class:"move-indicator"},ss={class:"controls-card"},ts={key:0,class:"status-message"},as={class:"controls-sidebar"},os={class:"puzzle-info-card"},ls={class:"puzzle-title"},ns={key:0,class:"promotion-dialog-overlay"},us={class:"promotion-dialog"},is={class:"promotion-pieces"},cs={key:1,class:"game-end-overlay"},rs={class:"game-end-dialog"},vs={class:"game-end-icon"},fs={key:0,class:"fas fa-trophy"},ps={key:1,class:"fas fa-handshake"},ds={class:"game-end-title"},hs={key:0},ks={key:1},gs={class:"game-end-subtitle"},bs={key:0},ws={key:1},ms={key:2},Cs={__name:"Puzzles",setup(Ms){const F=v(0),we=v(0),z=v(null),f=v(""),p=v(""),d=v(""),C=v("white"),N=v([]),te=v([]),q=v(!0),j=v(!1),X=v(!1),P=v(!1),$=v(!1),W=v(null),M=v(null),Q=v(!1),E=v(null),R=v(null),_=v(0),me=()=>{_.value=0};ge(()=>U.value?.solution||[]);const Ce=(s,e)=>{const t=U.value;if(!t||!t.solution||t.solution.length===0)return;const a=t.solution;if(_.value>=a.length)return;const o=a[_.value];if(Be(s,e)===o)if(f.value="âœ… Correct move!",p.value="alert-success",d.value="fas fa-check-circle",_.value++,_.value<a.length){const i=a[_.value],[u,r]=Le(i);setTimeout(()=>{de(u,r,!0),_.value++,C.value="white",_.value>=a.length&&setTimeout(()=>{I()},500)},400)}else setTimeout(()=>{I()},500);else f.value=`âŒ Wrong move! Expected ${o}`,p.value="alert-danger",d.value="fas fa-ban"},w=v({whiteKingMoved:!1,blackKingMoved:!1,whiteKingsideRookMoved:!1,whiteQueensideRookMoved:!1,blackKingsideRookMoved:!1,blackQueensideRookMoved:!1}),T=v([]),c=v([]),U=ge(()=>!T.value||T.value.length===0?null:T.value[F.value]||T.value[0]),Me=s=>{const e=[],t=s.split(" ")[0].split("/");for(let a of t)for(let o of a)if(isNaN(o))e.push(o);else for(let l=0;l<parseInt(o);l++)e.push("");return e},A=()=>{const s=U.value;if(s){c.value=[];for(let e=0;e<64;e++)c.value.push({piece:s.board[e]||null,selected:!1});console.log(s),C.value="white",N.value=[],te.value=[],q.value=!0,j.value=!1,X.value=!1,P.value=!1,$.value=!1,W.value=null,M.value=null,Q.value=!1,E.value=null,R.value=null,w.value={whiteKingMoved:!1,blackKingMoved:!1,whiteKingsideRookMoved:!1,whiteQueensideRookMoved:!1,blackKingsideRookMoved:!1,blackQueensideRookMoved:!1},me()}};De(T,s=>{s.length>0&&A()});const ze=async()=>{const a=(await(await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQyFaAasaUsySp8rSfkT_zmqo4fKdxYc8Fi7WZeIbpRvRGT2aiNM5rNepOy9rWHjzL0xvzNUz2gfrXo/pub?output=csv")).text()).split(`
`).map(l=>l.split(",")),o=a[0];T.value=a.slice(1).map(l=>{let i={};return o.forEach((u,r)=>i[u.trim()]=l[r]?.trim()),i.board=Me(i.fen),i.solution=i.solution?.split(" ").map(u=>u.trim()),i})},B=s=>s&&s===s.toUpperCase(),Y=s=>s&&s===s.toLowerCase(),ae=s=>s?C.value==="white"?B(s):Y(s):!1,D=s=>{const e=Math.floor(s/8),t=s%8;return{row:e,col:t}},h=(s,e)=>s<0||s>7||e<0||e>7?-1:s*8+e,O=s=>c.value[s]&&c.value[s].piece!==null,V=(s,e)=>{const t=c.value[s]?.piece;return t?e?Y(t):B(t):!1},oe=(s,e)=>{const t=c.value[s]?.piece;return t?e?B(t):Y(t):!1},Pe=s=>{const e=s?"K":"k";for(let t=0;t<64;t++)if(c.value[t]?.piece===e)return t;return-1},le=(s,e)=>{for(let t=0;t<64;t++){const a=c.value[t]?.piece;if(!a)continue;const o=B(a);if(o!==e)continue;const{row:l,col:i}=D(t);let u=[];switch(a.toLowerCase()){case"p":u.push(..._e(l,i,o));break;case"r":u.push(...Z(l,i,o));break;case"n":u.push(...ce(l,i,o));break;case"b":u.push(...J(l,i,o));break;case"q":u.push(...re(l,i,o));break;case"k":u.push(...ve(l,i,o));break}if(u.some(r=>r.index===s))return!0}return!1},H=s=>{const e=Pe(s);return e===-1?!1:le(e,!s)},Re=s=>{for(let e=0;e<64;e++){const t=c.value[e]?.piece;if(!t||B(t)!==s)continue;if(fe(e).length>0)return!0}return!1},ne=()=>{const s=H(!0),e=H(!1);j.value=s,X.value=e;const t=C.value==="white";Re(t)?s?(f.value+=" - White King in Check! â™”",p.value="alert-warning",d.value="fas fa-exclamation-triangle"):e&&(f.value+=" - Black King in Check! â™š",p.value="alert-warning",d.value="fas fa-exclamation-triangle"):t&&s?(P.value=!0,W.value="black",q.value=!1,f.value="â™š Checkmate! Black wins!",p.value="alert-danger",d.value="fas fa-trophy"):!t&&e?(P.value=!0,W.value="white",q.value=!1,f.value="â™” Checkmate! White wins!",p.value="alert-danger",d.value="fas fa-trophy"):($.value=!0,q.value=!1,f.value="ðŸ¤ Stalemate! Draw!",p.value="alert-warning",d.value="fas fa-handshake")},ue=(s,e,t)=>{const a=c.value[s]?.piece,o=c.value[e]?.piece;c.value[s].piece=null,c.value[e].piece=a;const l=H(t);return c.value[s].piece=a,c.value[e].piece=o,l},_e=(s,e,t)=>{const a=[],o=t?-1:1,l=h(s+o,e-1);l!==-1&&a.push({index:l});const i=h(s+o,e+1);return i!==-1&&a.push({index:i}),a},ie=(s,e,t)=>{const{row:a,col:o}=D(s);if(e){if(w.value.whiteKingMoved||t&&w.value.whiteKingsideRookMoved||!t&&w.value.whiteQueensideRookMoved)return!1}else if(w.value.blackKingMoved||t&&w.value.blackKingsideRookMoved||!t&&w.value.blackQueensideRookMoved)return!1;if(a!==(e?7:0)||o!==4)return!1;const u=h(a,t?7:0);if(c.value[u]?.piece!==(e?"R":"r"))return!1;const y=t?5:1,Ne=t?6:3;for(let L=y;L<=Ne;L++){const se=h(a,L);if(O(se))return!1}if(H(e))return!1;const We=4,Qe=t?6:2,ke=t?1:-1;for(let L=We;L!==Qe+ke;L+=ke){const se=h(a,L);if(le(se,!e))return!1}return!0},ye=(s,e)=>{const t=[],{row:a}=D(s);return ie(s,e,!0)&&t.push({index:h(a,6),isCastling:!0,isKingside:!0}),ie(s,e,!1)&&t.push({index:h(a,2),isCastling:!0,isKingside:!1}),t},Se=(s,e,t)=>{const a=[],o=t?-1:1,l=t?6:1,i=h(s+o,e);if(i!==-1&&!O(i)&&(a.push({index:i}),s===l)){const b=h(s+o*2,e);b!==-1&&!O(b)&&a.push({index:b,isDoublePawnMove:!0})}const u=h(s+o,e-1);u!==-1&&V(u,t)&&a.push({index:u});const r=h(s+o,e+1);if(r!==-1&&V(r,t)&&a.push({index:r}),M.value!==null){const b=Math.floor(M.value/8),y=M.value%8;s+o===b&&(e-1===y&&a.push({index:M.value,isEnPassant:!0}),e+1===y&&a.push({index:M.value,isEnPassant:!0}))}return a},Z=(s,e,t)=>{const a=[],o=[[0,1],[0,-1],[1,0],[-1,0]];for(const[l,i]of o)for(let u=1;u<8;u++){const r=h(s+l*u,e+i*u);if(r===-1)break;if(!O(r))a.push({index:r});else{V(r,t)&&a.push({index:r});break}}return a},ce=(s,e,t)=>{const a=[],o=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[l,i]of o){const u=h(s+l,e+i);u!==-1&&!oe(u,t)&&a.push({index:u})}return a},J=(s,e,t)=>{const a=[],o=[[1,1],[1,-1],[-1,1],[-1,-1]];for(const[l,i]of o)for(let u=1;u<8;u++){const r=h(s+l*u,e+i*u);if(r===-1)break;if(!O(r))a.push({index:r});else{V(r,t)&&a.push({index:r});break}}return a},re=(s,e,t)=>[...Z(s,e,t),...J(s,e,t)],ve=(s,e,t)=>{const a=[],o=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[l,i]of o){const u=h(s+l,e+i);u!==-1&&!oe(u,t)&&a.push({index:u})}return a},fe=s=>{const e=c.value[s]?.piece;if(!e)return[];const{row:t,col:a}=D(s),o=B(e);let l=[];switch(e.toLowerCase()){case"p":l.push(...Se(t,a,o));break;case"r":l.push(...Z(t,a,o));break;case"n":l.push(...ce(t,a,o));break;case"b":l.push(...J(t,a,o));break;case"q":l.push(...re(t,a,o));break;case"k":l.push(...ve(t,a,o)),l.push(...ye(s,o));break}return l.filter(u=>!ue(s,u.index,o)).filter(u=>u.index>=0&&u.index<64)},pe=s=>{const e=fe(s);N.value=e},ee=s=>N.value.some(e=>e.index===s),Ke=s=>{const e=Math.floor(s/8),t=s%8,a=(e+t)%2===0;let o=["chess-square"];o.push(a?"light-square":"dark-square"),c.value[s].selected&&o.push("selected-square"),ee(s)&&o.push("valid-move-square");const l=c.value[s]?.piece;return(l==="K"&&j.value||l==="k"&&X.value)&&o.push("king-in-check"),o},qe=s=>s?s===s.toUpperCase()?"white-piece":"black-piece":"",Te=(s,e)=>{e==="K"?w.value.whiteKingMoved=!0:e==="k"?w.value.blackKingMoved=!0:e==="R"?(s===63&&(w.value.whiteKingsideRookMoved=!0),s===56&&(w.value.whiteQueensideRookMoved=!0)):e==="r"&&(s===7&&(w.value.blackKingsideRookMoved=!0),s===0&&(w.value.blackQueensideRookMoved=!0))},Be=(s,e)=>{const t="abcdefgh",a=Math.floor(s/8),o=s%8,l=Math.floor(e/8),i=e%8;return`${t[o]}${8-a}${t[i]}${8-l}`},Le=s=>{const e="abcdefgh",t=e.indexOf(s[0]),a=8-parseInt(s[1]),o=e.indexOf(s[2]),l=8-parseInt(s[3]);return[a*8+t,l*8+o]};v(0),v([]);const de=(s,e,t=!1)=>{const a=c.value[s]?.piece;if(!a)return;const o=c.value[e]?.piece,l=B(a);if(!t&&ue(s,e,l)){f.value="âš ï¸ Illegal move! This would leave your king in check.",p.value="alert-danger",d.value="fas fa-ban",x();return}Te(s,a),M.value,M.value=null;const i=N.value.find(r=>r.index===e);if(i?.isEnPassant){const b=e+(l?1:-1)*8;c.value[b].piece=null}if(i?.isCastling){const{row:r}=D(s);if(i.isKingside){const b=h(r,7),y=h(r,5);c.value[y].piece=c.value[b].piece,c.value[b].piece=null}else{const b=h(r,0),y=h(r,3);c.value[y].piece=c.value[b].piece,c.value[b].piece=null}}if(c.value[e].piece=a,c.value[s].piece=null,a.toLowerCase()==="p"&&i?.isDoublePawnMove){const r=l?1:-1;M.value=e+r*8}const u=Math.floor(e/8);if(!t&&a.toLowerCase()==="p"&&(u===0||u===7)){Q.value=!0,E.value=e,R.value=l,q.value=!1,f.value="ðŸ‘‘ Choose a piece for promotion!",p.value="alert-info",d.value="fas fa-crown";return}te.value.push({from:s,to:e,piece:a,captured:o,turn:C.value,castling:i?.isCastling||!1,enPassant:i?.isEnPassant||!1}),x(),t||(C.value=C.value==="white"?"black":"white"),ne(),t||Ce(s,e)},$e=s=>{if(!q.value||Q.value)return;const e=c.value[s];z.value===null?e.piece&&ae(e.piece)?(z.value=s,e.selected=!0,pe(s),f.value=`${C.value==="white"?"White":"Black"} to move`,p.value="alert-info",d.value="fas fa-chess"):e.piece&&(f.value=`It's ${C.value}'s turn!`,p.value="alert-warning",d.value="fas fa-exclamation-triangle"):z.value===s?x():ee(s)?de(z.value,s):e.piece&&ae(e.piece)?(x(),z.value=s,e.selected=!0,pe(s)):(f.value="Invalid move! Try again.",p.value="alert-danger",d.value="fas fa-times")},x=()=>{z.value!==null&&(c.value[z.value].selected=!1),z.value=null,N.value=[]},he=()=>{x(),A(),f.value="Puzzle reset! White to move.",p.value="alert-info",d.value="fas fa-undo"},xe=()=>{const s=U.value.solution[0];f.value=`Hint: Try ${s}`,p.value="alert-info",d.value="fas fa-lightbulb"},Fe=()=>{f.value="Good move! Keep going...",p.value="alert-success",d.value="fas fa-check-circle"},I=()=>{F.value<T.value.length-1?F.value++:F.value=0,x(),A(),f.value="New puzzle loaded! White to move.",p.value="alert-success",d.value="fas fa-puzzle-piece",we.value++},G=s=>{if(E.value===null)return;const e=R.value?s.toUpperCase():s.toLowerCase();c.value[E.value].piece=e,Q.value=!1,q.value=!0,f.value=`Pawn promoted to ${s.toUpperCase()}! ðŸ‘‘`,p.value="alert-success",d.value="fas fa-crown",E.value=null,R.value=null,C.value=C.value==="white"?"black":"white",ne()};return Oe(()=>{ze(),document.title="IISER-TVM Chess Club - Puzzles",A(),f.value="White to move. Select a piece to start!",p.value="alert-info",d.value="fas fa-chess"}),(s,e)=>(g(),k("div",Ve,[n("section",He,[n("div",Ie,[n("div",Ge,[n("div",je,[n("div",Xe,[n("div",Ye,[(g(!0),k(Ue,null,Ae(c.value,(t,a)=>(g(),k("div",{key:a,class:S(Ke(a)),onClick:o=>$e(a)},[t.piece?(g(),k("div",{key:0,class:S([qe(t.piece),"chess-piece"]),"data-piece":t.piece},null,10,Je)):m("",!0),ee(a)?(g(),k("div",es)):m("",!0)],10,Ze))),128))],512)]),n("div",ss,[f.value?(g(),k("div",ts,[n("div",{class:S([p.value,"alert"])},[n("i",{class:S([d.value,"me-2"])},null,2),K(be(f.value),1)],2)])):m("",!0),n("div",as,[n("div",os,[n("h3",ls,[e[4]||(e[4]=n("i",{class:"fas fa-puzzle-piece me-2"},null,-1)),K("Puzzle #"+be(F.value+1),1)])]),e[9]||(e[9]=n("h4",{class:"controls-title"},"Controls",-1)),n("div",{class:"control-buttons-vertical"},[n("button",{class:"btn btn-control btn-reset",onClick:he},[...e[5]||(e[5]=[n("i",{class:"fas fa-undo me-2"},null,-1),K("Reset ",-1)])]),n("button",{class:"btn btn-control btn-hint",onClick:xe},[...e[6]||(e[6]=[n("i",{class:"fas fa-lightbulb me-2"},null,-1),K("Hint ",-1)])]),n("button",{class:"btn btn-control btn-check",onClick:Fe},[...e[7]||(e[7]=[n("i",{class:"fas fa-check me-2"},null,-1),K("Check Solution ",-1)])]),n("button",{class:"btn btn-control btn-next",onClick:I},[...e[8]||(e[8]=[n("i",{class:"fas fa-arrow-right me-2"},null,-1),K("Next Puzzle ",-1)])])])])])])])]),Q.value?(g(),k("div",ns,[n("div",us,[e[14]||(e[14]=n("h3",{class:"text-center"},"Choose Promotion Piece",-1)),n("div",is,[n("button",{onClick:e[0]||(e[0]=t=>G("q")),class:"promotion-btn"},[n("div",{class:S([R.value?"white-piece":"black-piece","promotion-piece"])},"â™•",2),e[10]||(e[10]=n("span",null,"Queen",-1))]),n("button",{onClick:e[1]||(e[1]=t=>G("r")),class:"promotion-btn"},[n("div",{class:S([R.value?"white-piece":"black-piece","promotion-piece"])},"â™–",2),e[11]||(e[11]=n("span",null,"Rook",-1))]),n("button",{onClick:e[2]||(e[2]=t=>G("b")),class:"promotion-btn"},[n("div",{class:S([R.value?"white-piece":"black-piece","promotion-piece"])},"â™—",2),e[12]||(e[12]=n("span",null,"Bishop",-1))]),n("button",{onClick:e[3]||(e[3]=t=>G("n")),class:"promotion-btn"},[n("div",{class:S([R.value?"white-piece":"black-piece","promotion-piece"])},"â™˜",2),e[13]||(e[13]=n("span",null,"Knight",-1))])])])])):m("",!0),P.value||$.value?(g(),k("div",cs,[n("div",rs,[n("div",vs,[P.value?(g(),k("i",fs)):m("",!0),$.value?(g(),k("i",ps)):m("",!0)]),n("h2",ds,[P.value?(g(),k("span",hs,"Checkmate!")):m("",!0),$.value?(g(),k("span",ks,"Stalemate!")):m("",!0)]),n("p",gs,[P.value&&W.value==="white"?(g(),k("span",bs,"â™” White Wins!")):m("",!0),P.value&&W.value==="black"?(g(),k("span",ws,"â™š Black Wins!")):m("",!0),$.value?(g(),k("span",ms,"It's a Draw!")):m("",!0)]),n("div",{class:"game-end-buttons"},[n("button",{onClick:he,class:"btn btn-light btn-lg"},[...e[15]||(e[15]=[n("i",{class:"fas fa-redo me-2"},null,-1),K("Play Again ",-1)])]),n("button",{onClick:I,class:"btn btn-warning btn-lg"},[...e[16]||(e[16]=[n("i",{class:"fas fa-arrow-right me-2"},null,-1),K("Next Puzzle ",-1)])])])])])):m("",!0)])]))}},Ps=Ee(Cs,[["__scopeId","data-v-e928ea80"]]);export{Ps as default};
