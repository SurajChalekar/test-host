import{_ as Ee,r as v,c as ge,w as De,o as Oe,a as k,b as g,e as n,f as m,F as Ue,h as Ae,n as K,g as z,t as be}from"./index-BdV1KZIb.js";const Ve={class:"puzzles-page"},He={class:"puzzle-content"},Ie={class:"puzzle-container"},Ge={class:"puzzle-layout"},je={class:"chess-container"},Xe={class:"board-wrapper"},Ye={class:"chess-board",ref:"chessBoard"},Ze=["onClick"],Je=["data-piece"],es={key:1,class:"move-indicator"},ss={class:"controls-card"},ts={key:0,class:"status-message"},os={class:"controls-sidebar"},as={class:"puzzle-info-card"},ls={class:"puzzle-title"},ns={class:"control-buttons-vertical"},us={key:0,class:"promotion-dialog-overlay"},is={class:"promotion-dialog"},cs={class:"promotion-pieces"},rs={key:1,class:"game-end-overlay"},vs={class:"game-end-dialog"},fs={class:"game-end-icon"},ps={key:0,class:"fas fa-trophy"},ds={key:1,class:"fas fa-handshake"},hs={class:"game-end-title"},ks={key:0},gs={key:1},bs={class:"game-end-subtitle"},ws={key:0},ms={key:1},Cs={key:2},Ms={__name:"PuzzlesMobile",setup(zs){const N=v(0),we=v(0),P=v(null),f=v(""),p=v(""),d=v(""),C=v("white"),W=v([]),te=v([]),q=v(!0),j=v(!1),X=v(!1),R=v(!1),$=v(!1),x=v(null),M=v(null),Q=v(!1),E=v(null),_=v(null),y=v(0),me=()=>{y.value=0};ge(()=>U.value?.solution||[]);const Ce=(s,e)=>{const t=U.value;if(!t||!t.solution||t.solution.length===0)return;const o=t.solution;if(y.value>=o.length)return;const a=o[y.value];if(Te(s,e)===a)if(f.value="âœ… Correct move!",p.value="alert-success",d.value="fas fa-check-circle",y.value++,y.value<o.length){const i=o[y.value],[u,r]=Le(i);setTimeout(()=>{de(u,r,!0),y.value++,C.value="white",y.value>=o.length&&setTimeout(()=>{I()},500)},400)}else setTimeout(()=>{I()},500);else f.value=`âŒ Wrong move! Expected ${a}`,p.value="alert-danger",d.value="fas fa-ban"},w=v({whiteKingMoved:!1,blackKingMoved:!1,whiteKingsideRookMoved:!1,whiteQueensideRookMoved:!1,blackKingsideRookMoved:!1,blackQueensideRookMoved:!1}),B=v([]),c=v([]),U=ge(()=>!B.value||B.value.length===0?null:B.value[N.value]||B.value[0]),Me=s=>{const e=[],t=s.split(" ")[0].split("/");for(let o of t)for(let a of o)if(isNaN(a))e.push(a);else for(let l=0;l<parseInt(a);l++)e.push("");return e},A=()=>{const s=U.value;if(s){c.value=[];for(let e=0;e<64;e++)c.value.push({piece:s.board[e]||null,selected:!1});console.log(s),C.value="white",W.value=[],te.value=[],q.value=!0,j.value=!1,X.value=!1,R.value=!1,$.value=!1,x.value=null,M.value=null,Q.value=!1,E.value=null,_.value=null,w.value={whiteKingMoved:!1,blackKingMoved:!1,whiteKingsideRookMoved:!1,whiteQueensideRookMoved:!1,blackKingsideRookMoved:!1,blackQueensideRookMoved:!1},me()}};De(B,s=>{s.length>0&&A()});const ze=async()=>{const o=(await(await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQyFaAasaUsySp8rSfkT_zmqo4fKdxYc8Fi7WZeIbpRvRGT2aiNM5rNepOy9rWHjzL0xvzNUz2gfrXo/pub?output=csv")).text()).split(`
`).map(l=>l.split(",")),a=o[0];B.value=o.slice(1).map(l=>{let i={};return a.forEach((u,r)=>i[u.trim()]=l[r]?.trim()),i.board=Me(i.fen),i.solution=i.solution?.split(" ").map(u=>u.trim()),i})},T=s=>s&&s===s.toUpperCase(),Y=s=>s&&s===s.toLowerCase(),oe=s=>s?C.value==="white"?T(s):Y(s):!1,D=s=>{const e=Math.floor(s/8),t=s%8;return{row:e,col:t}},h=(s,e)=>s<0||s>7||e<0||e>7?-1:s*8+e,O=s=>c.value[s]&&c.value[s].piece!==null,V=(s,e)=>{const t=c.value[s]?.piece;return t?e?Y(t):T(t):!1},ae=(s,e)=>{const t=c.value[s]?.piece;return t?e?T(t):Y(t):!1},Pe=s=>{const e=s?"K":"k";for(let t=0;t<64;t++)if(c.value[t]?.piece===e)return t;return-1},le=(s,e)=>{for(let t=0;t<64;t++){const o=c.value[t]?.piece;if(!o)continue;const a=T(o);if(a!==e)continue;const{row:l,col:i}=D(t);let u=[];switch(o.toLowerCase()){case"p":u.push(..._e(l,i,a));break;case"r":u.push(...Z(l,i,a));break;case"n":u.push(...ce(l,i,a));break;case"b":u.push(...J(l,i,a));break;case"q":u.push(...re(l,i,a));break;case"k":u.push(...ve(l,i,a));break}if(u.some(r=>r.index===s))return!0}return!1},H=s=>{const e=Pe(s);return e===-1?!1:le(e,!s)},Re=s=>{for(let e=0;e<64;e++){const t=c.value[e]?.piece;if(!t||T(t)!==s)continue;if(fe(e).length>0)return!0}return!1},ne=()=>{const s=H(!0),e=H(!1);j.value=s,X.value=e;const t=C.value==="white";Re(t)?s?(f.value+=" - White King in Check! â™”",p.value="alert-warning",d.value="fas fa-exclamation-triangle"):e&&(f.value+=" - Black King in Check! â™š",p.value="alert-warning",d.value="fas fa-exclamation-triangle"):t&&s?(R.value=!0,x.value="black",q.value=!1,f.value="â™š Checkmate! Black wins!",p.value="alert-danger",d.value="fas fa-trophy"):!t&&e?(R.value=!0,x.value="white",q.value=!1,f.value="â™” Checkmate! White wins!",p.value="alert-danger",d.value="fas fa-trophy"):($.value=!0,q.value=!1,f.value="ðŸ¤ Stalemate! Draw!",p.value="alert-warning",d.value="fas fa-handshake")},ue=(s,e,t)=>{const o=c.value[s]?.piece,a=c.value[e]?.piece;c.value[s].piece=null,c.value[e].piece=o;const l=H(t);return c.value[s].piece=o,c.value[e].piece=a,l},_e=(s,e,t)=>{const o=[],a=t?-1:1,l=h(s+a,e-1);l!==-1&&o.push({index:l});const i=h(s+a,e+1);return i!==-1&&o.push({index:i}),o},ie=(s,e,t)=>{const{row:o,col:a}=D(s);if(e){if(w.value.whiteKingMoved||t&&w.value.whiteKingsideRookMoved||!t&&w.value.whiteQueensideRookMoved)return!1}else if(w.value.blackKingMoved||t&&w.value.blackKingsideRookMoved||!t&&w.value.blackQueensideRookMoved)return!1;if(o!==(e?7:0)||a!==4)return!1;const u=h(o,t?7:0);if(c.value[u]?.piece!==(e?"R":"r"))return!1;const S=t?5:1,We=t?6:3;for(let L=S;L<=We;L++){const se=h(o,L);if(O(se))return!1}if(H(e))return!1;const xe=4,Qe=t?6:2,ke=t?1:-1;for(let L=xe;L!==Qe+ke;L+=ke){const se=h(o,L);if(le(se,!e))return!1}return!0},ye=(s,e)=>{const t=[],{row:o}=D(s);return ie(s,e,!0)&&t.push({index:h(o,6),isCastling:!0,isKingside:!0}),ie(s,e,!1)&&t.push({index:h(o,2),isCastling:!0,isKingside:!1}),t},Se=(s,e,t)=>{const o=[],a=t?-1:1,l=t?6:1,i=h(s+a,e);if(i!==-1&&!O(i)&&(o.push({index:i}),s===l)){const b=h(s+a*2,e);b!==-1&&!O(b)&&o.push({index:b,isDoublePawnMove:!0})}const u=h(s+a,e-1);u!==-1&&V(u,t)&&o.push({index:u});const r=h(s+a,e+1);if(r!==-1&&V(r,t)&&o.push({index:r}),M.value!==null){const b=Math.floor(M.value/8),S=M.value%8;s+a===b&&(e-1===S&&o.push({index:M.value,isEnPassant:!0}),e+1===S&&o.push({index:M.value,isEnPassant:!0}))}return o},Z=(s,e,t)=>{const o=[],a=[[0,1],[0,-1],[1,0],[-1,0]];for(const[l,i]of a)for(let u=1;u<8;u++){const r=h(s+l*u,e+i*u);if(r===-1)break;if(!O(r))o.push({index:r});else{V(r,t)&&o.push({index:r});break}}return o},ce=(s,e,t)=>{const o=[],a=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[l,i]of a){const u=h(s+l,e+i);u!==-1&&!ae(u,t)&&o.push({index:u})}return o},J=(s,e,t)=>{const o=[],a=[[1,1],[1,-1],[-1,1],[-1,-1]];for(const[l,i]of a)for(let u=1;u<8;u++){const r=h(s+l*u,e+i*u);if(r===-1)break;if(!O(r))o.push({index:r});else{V(r,t)&&o.push({index:r});break}}return o},re=(s,e,t)=>[...Z(s,e,t),...J(s,e,t)],ve=(s,e,t)=>{const o=[],a=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[l,i]of a){const u=h(s+l,e+i);u!==-1&&!ae(u,t)&&o.push({index:u})}return o},fe=s=>{const e=c.value[s]?.piece;if(!e)return[];const{row:t,col:o}=D(s),a=T(e);let l=[];switch(e.toLowerCase()){case"p":l.push(...Se(t,o,a));break;case"r":l.push(...Z(t,o,a));break;case"n":l.push(...ce(t,o,a));break;case"b":l.push(...J(t,o,a));break;case"q":l.push(...re(t,o,a));break;case"k":l.push(...ve(t,o,a)),l.push(...ye(s,a));break}return l.filter(u=>!ue(s,u.index,a)).filter(u=>u.index>=0&&u.index<64)},pe=s=>{const e=fe(s);W.value=e},ee=s=>W.value.some(e=>e.index===s),Ke=s=>{const e=Math.floor(s/8),t=s%8,o=(e+t)%2===0;let a=["chess-square"];a.push(o?"light-square":"dark-square"),c.value[s].selected&&a.push("selected-square"),ee(s)&&a.push("valid-move-square");const l=c.value[s]?.piece;return(l==="K"&&j.value||l==="k"&&X.value)&&a.push("king-in-check"),a},qe=s=>s?s===s.toUpperCase()?"white-piece":"black-piece":"",Be=(s,e)=>{e==="K"?w.value.whiteKingMoved=!0:e==="k"?w.value.blackKingMoved=!0:e==="R"?(s===63&&(w.value.whiteKingsideRookMoved=!0),s===56&&(w.value.whiteQueensideRookMoved=!0)):e==="r"&&(s===7&&(w.value.blackKingsideRookMoved=!0),s===0&&(w.value.blackQueensideRookMoved=!0))},Te=(s,e)=>{const t="abcdefgh",o=Math.floor(s/8),a=s%8,l=Math.floor(e/8),i=e%8;return`${t[a]}${8-o}${t[i]}${8-l}`},Le=s=>{const e="abcdefgh",t=e.indexOf(s[0]),o=8-parseInt(s[1]),a=e.indexOf(s[2]),l=8-parseInt(s[3]);return[o*8+t,l*8+a]};v(0),v([]);const de=(s,e,t=!1)=>{const o=c.value[s]?.piece;if(!o)return;const a=c.value[e]?.piece,l=T(o);if(!t&&ue(s,e,l)){f.value="âš ï¸ Illegal move! This would leave your king in check.",p.value="alert-danger",d.value="fas fa-ban",F();return}Be(s,o),M.value,M.value=null;const i=W.value.find(r=>r.index===e);if(i?.isEnPassant){const b=e+(l?1:-1)*8;c.value[b].piece=null}if(i?.isCastling){const{row:r}=D(s);if(i.isKingside){const b=h(r,7),S=h(r,5);c.value[S].piece=c.value[b].piece,c.value[b].piece=null}else{const b=h(r,0),S=h(r,3);c.value[S].piece=c.value[b].piece,c.value[b].piece=null}}if(c.value[e].piece=o,c.value[s].piece=null,o.toLowerCase()==="p"&&i?.isDoublePawnMove){const r=l?1:-1;M.value=e+r*8}const u=Math.floor(e/8);if(!t&&o.toLowerCase()==="p"&&(u===0||u===7)){Q.value=!0,E.value=e,_.value=l,q.value=!1,f.value="ðŸ‘‘ Choose a piece for promotion!",p.value="alert-info",d.value="fas fa-crown";return}te.value.push({from:s,to:e,piece:o,captured:a,turn:C.value,castling:i?.isCastling||!1,enPassant:i?.isEnPassant||!1}),F(),t||(C.value=C.value==="white"?"black":"white"),ne(),t||Ce(s,e)},$e=s=>{if(!q.value||Q.value)return;const e=c.value[s];P.value===null?e.piece&&oe(e.piece)?(P.value=s,e.selected=!0,pe(s),f.value=`${C.value==="white"?"White":"Black"} to move`,p.value="alert-info",d.value="fas fa-chess"):e.piece&&(f.value=`It's ${C.value}'s turn!`,p.value="alert-warning",d.value="fas fa-exclamation-triangle"):P.value===s?F():ee(s)?de(P.value,s):e.piece&&oe(e.piece)?(F(),P.value=s,e.selected=!0,pe(s)):(f.value="Invalid move! Try again.",p.value="alert-danger",d.value="fas fa-times")},F=()=>{P.value!==null&&(c.value[P.value].selected=!1),P.value=null,W.value=[]},he=()=>{F(),A(),f.value="Puzzle reset! White to move.",p.value="alert-info",d.value="fas fa-undo"},Fe=()=>{const s=U.value.solution[0];f.value=`Hint: Try ${s}`,p.value="alert-info",d.value="fas fa-lightbulb"},Ne=()=>{f.value="Good move! Keep going...",p.value="alert-success",d.value="fas fa-check-circle"},I=()=>{N.value<B.value.length-1?N.value++:N.value=0,F(),A(),f.value="New puzzle loaded! White to move.",p.value="alert-success",d.value="fas fa-puzzle-piece",we.value++},G=s=>{if(E.value===null)return;const e=_.value?s.toUpperCase():s.toLowerCase();c.value[E.value].piece=e,Q.value=!1,q.value=!0,f.value=`Pawn promoted to ${s.toUpperCase()}! ðŸ‘‘`,p.value="alert-success",d.value="fas fa-crown",E.value=null,_.value=null,C.value=C.value==="white"?"black":"white",ne()};return Oe(()=>{ze(),document.title="IISER-TVM Chess Club - Puzzles",A(),f.value="White to move. Select a piece to start!",p.value="alert-info",d.value="fas fa-chess"}),(s,e)=>(g(),k("div",Ve,[n("section",He,[n("div",Ie,[n("div",Ge,[n("div",je,[n("div",Xe,[n("div",Ye,[(g(!0),k(Ue,null,Ae(c.value,(t,o)=>(g(),k("div",{key:o,class:K(Ke(o)),onClick:a=>$e(o)},[t.piece?(g(),k("div",{key:0,class:K([qe(t.piece),"chess-piece"]),"data-piece":t.piece},null,10,Je)):m("",!0),ee(o)?(g(),k("div",es)):m("",!0)],10,Ze))),128))],512)]),n("div",ss,[f.value?(g(),k("div",ts,[n("div",{class:K([p.value,"alert"])},[n("i",{class:K([d.value,"me-2"])},null,2),z(be(f.value),1)],2)])):m("",!0),n("div",os,[n("div",as,[n("h3",ls,[e[5]||(e[5]=n("i",{class:"fas fa-puzzle-piece me-2"},null,-1)),z("Puzzle #"+be(N.value+1),1)])]),e[11]||(e[11]=n("h4",{class:"controls-title"},"Controls",-1)),n("div",ns,[n("button",{class:"btn btn-control btn-reset",onClick:he},[...e[6]||(e[6]=[n("i",{class:"fas fa-undo me-2"},null,-1),z("Reset ",-1)])]),n("button",{class:"btn btn-control btn-hint",onClick:Fe},[...e[7]||(e[7]=[n("i",{class:"fas fa-lightbulb me-2"},null,-1),z("Hint ",-1)])]),n("button",{class:"btn btn-control btn-check",onClick:Ne},[...e[8]||(e[8]=[n("i",{class:"fas fa-check me-2"},null,-1),z("Check Solution ",-1)])]),n("button",{class:"btn btn-control btn-next",onClick:I},[...e[9]||(e[9]=[n("i",{class:"fas fa-arrow-right me-2"},null,-1),z("Next Puzzle ",-1)])]),n("button",{class:"btn btn-control btn-back",onClick:e[0]||(e[0]=(...t)=>s.backPuzzle&&s.backPuzzle(...t))},[...e[10]||(e[10]=[n("i",{class:"fas fa-arrow-left me-2"},null,-1),z("Back ",-1)])])])])])])])]),Q.value?(g(),k("div",us,[n("div",is,[e[16]||(e[16]=n("h3",{class:"text-center"},"Choose Promotion Piece",-1)),n("div",cs,[n("button",{onClick:e[1]||(e[1]=t=>G("q")),class:"promotion-btn"},[n("div",{class:K([_.value?"white-piece":"black-piece","promotion-piece"])},"â™•",2),e[12]||(e[12]=n("span",null,"Queen",-1))]),n("button",{onClick:e[2]||(e[2]=t=>G("r")),class:"promotion-btn"},[n("div",{class:K([_.value?"white-piece":"black-piece","promotion-piece"])},"â™–",2),e[13]||(e[13]=n("span",null,"Rook",-1))]),n("button",{onClick:e[3]||(e[3]=t=>G("b")),class:"promotion-btn"},[n("div",{class:K([_.value?"white-piece":"black-piece","promotion-piece"])},"â™—",2),e[14]||(e[14]=n("span",null,"Bishop",-1))]),n("button",{onClick:e[4]||(e[4]=t=>G("n")),class:"promotion-btn"},[n("div",{class:K([_.value?"white-piece":"black-piece","promotion-piece"])},"â™˜",2),e[15]||(e[15]=n("span",null,"Knight",-1))])])])])):m("",!0),R.value||$.value?(g(),k("div",rs,[n("div",vs,[n("div",fs,[R.value?(g(),k("i",ps)):m("",!0),$.value?(g(),k("i",ds)):m("",!0)]),n("h2",hs,[R.value?(g(),k("span",ks,"Checkmate!")):m("",!0),$.value?(g(),k("span",gs,"Stalemate!")):m("",!0)]),n("p",bs,[R.value&&x.value==="white"?(g(),k("span",ws,"â™” White Wins!")):m("",!0),R.value&&x.value==="black"?(g(),k("span",ms,"â™š Black Wins!")):m("",!0),$.value?(g(),k("span",Cs,"It's a Draw!")):m("",!0)]),n("div",{class:"game-end-buttons"},[n("button",{onClick:he,class:"btn btn-light btn-lg"},[...e[17]||(e[17]=[n("i",{class:"fas fa-redo me-2"},null,-1),z("Play Again ",-1)])]),n("button",{onClick:I,class:"btn btn-warning btn-lg"},[...e[18]||(e[18]=[n("i",{class:"fas fa-arrow-right me-2"},null,-1),z("Next Puzzle ",-1)])])])])])):m("",!0)])]))}},Rs=Ee(Ms,[["__scopeId","data-v-fbc255d0"]]);export{Rs as default};
